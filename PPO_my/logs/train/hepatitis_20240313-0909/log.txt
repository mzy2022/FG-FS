2024-03-13 09:09:32,733 AutoFE.py:35 __init__ INFO | Namespace(cuda='0', epochs=100, ppo_epochs=20, episodes=4, file_name='hepatitis', mode='classify', model='rf', metric='f1', seed=1, train_size=0.7, cv=5, shuffle=False, d_model=128, d_k=32, d_v=32, d_ff=64, n_heads=6, worker=1, steps_num=5, lr=0.0001, entropy_weight=0.0001, baseline_weight=0.95, gama=0.9, gae_lambda=0.95, batch_size=4, c_columns=['V0', 'V13', 'V14', 'V15', 'V16', 'V17'], d_columns=['V1', 'V2', 'V3', 'V4', 'V5', 'V6', 'V7', 'V8', 'V9', 'V10', 'V11', 'V12', 'V18'], target='label')
2024-03-13 09:09:32,733 AutoFE.py:36 __init__ INFO | File name: hepatitis
2024-03-13 09:09:32,733 AutoFE.py:37 __init__ INFO | Data shape: (155, 20)
2024-03-13 09:09:34,254 AutoFE.py:90 set_cuda INFO | Use device: 0, cuda:0, NVIDIA GeForce RTX 4060 Laptop GPU
2024-03-13 09:09:34,256 AutoFE.py:80 __init__ INFO | Done AutoFE initialization.
2024-03-13 09:09:34,311 AutoFE.py:103 fit_attention INFO | score_b=0.8129032258064516, scores_b=[0.80645161 0.80645161 0.87096774 0.70967742 0.87096774]
2024-03-13 09:09:38,621 AutoFE.py:157 fit_attention INFO | worker1 ,results:[0.5806, 0.6323, 0.471, 0.6774, 0.7548],cv:[ 0.          0.         -0.06451613  0.09677419  0.        ],
2024-03-13 09:09:38,628 AutoFE.py:157 fit_attention INFO | worker2 ,results:[0.6, 0.6581, 0.7226, 0.6258, 0.7484],cv:[ 0.          0.         -0.06451613  0.06451613  0.        ],
2024-03-13 09:09:38,629 AutoFE.py:157 fit_attention INFO | worker3 ,results:[0.4839, 0.7548, 0.5419, 0.6452, 0.6903],cv:[ 0.03225806  0.06451613  0.          0.06451613 -0.12903226],
2024-03-13 09:09:38,630 AutoFE.py:157 fit_attention INFO | worker4 ,results:[0.5806, 0.6194, 0.6065, 0.6, 0.6968],cv:[ 0.06451613  0.06451613 -0.03225806  0.06451613 -0.09677419],
2024-03-13 09:09:38,631 AutoFE.py:174 fit_attention INFO | epoch:0,baseline:[0.561275 0.66615  0.5855   0.6371   0.722575],score_b:0.8129032258064516,scores_b:[0.80645161 0.80645161 0.87096774 0.70967742 0.87096774]
2024-03-13 09:09:38,631 AutoFE.py:180 fit_attention INFO | top_1:score:0.8387096774193548
2024-03-13 09:09:38,631 AutoFE.py:180 fit_attention INFO | top_2:score:0.8258064516129032
2024-03-13 09:09:38,631 AutoFE.py:180 fit_attention INFO | top_3:score:0.8193548387096774
2024-03-13 09:09:38,631 AutoFE.py:180 fit_attention INFO | top_4:score:0.8193548387096774
2024-03-13 09:09:38,631 AutoFE.py:180 fit_attention INFO | top_5:score:0.8193548387096774
2024-03-13 09:09:39,459 ppo.py:174 update INFO | total_loss_c:-0.6708763168501477,actor_loss:-0.5231599548208337,entory_loss:-0.14771635830402374
2024-03-13 09:09:41,641 ppo.py:174 update INFO | total_loss_c:-0.7278443735310329,actor_loss:-0.5801285963722957,entory_loss:-0.14771577715873718
2024-03-13 09:09:43,005 ppo.py:174 update INFO | total_loss_c:-0.784856249722174,actor_loss:-0.6371414262377533,entory_loss:-0.14771482348442078
2024-03-13 09:09:44,346 ppo.py:174 update INFO | total_loss_c:-0.8416952853397639,actor_loss:-0.6939816986517222,entory_loss:-0.1477135866880417
2024-03-13 09:09:45,709 ppo.py:174 update INFO | total_loss_c:-0.8969671645643196,actor_loss:-0.7492551350476226,entory_loss:-0.14771203696727753
2024-03-13 09:09:47,016 ppo.py:174 update INFO | total_loss_c:-0.9517365683846828,actor_loss:-0.8040263456337806,entory_loss:-0.14771021902561188
2024-03-13 09:09:48,298 ppo.py:174 update INFO | total_loss_c:-1.0066056275728297,actor_loss:-0.858897483533914,entory_loss:-0.14770814776420593
2024-03-13 09:09:49,628 ppo.py:174 update INFO | total_loss_c:-1.0612052133640875,actor_loss:-0.913499431159221,entory_loss:-0.1477057784795761
2024-03-13 09:09:50,904 ppo.py:174 update INFO | total_loss_c:-1.1149333933469876,actor_loss:-0.9672302337464913,entory_loss:-0.147703155875206
2024-03-13 09:09:52,267 ppo.py:174 update INFO | total_loss_c:-1.1684116609095954,actor_loss:-1.0207113399803065,entory_loss:-0.14770032465457916
2024-03-13 09:09:53,616 ppo.py:174 update INFO | total_loss_c:-1.221146226842917,actor_loss:-1.0734489792781243,entory_loss:-0.14769724011421204
2024-03-13 09:09:54,900 ppo.py:174 update INFO | total_loss_c:-1.2725627611334618,actor_loss:-1.1248688030000027,entory_loss:-0.1476939469575882
2024-03-13 09:09:56,221 ppo.py:174 update INFO | total_loss_c:-1.322593061807364,actor_loss:-1.1749025570180116,entory_loss:-0.14769050478935242
2024-03-13 09:09:57,595 ppo.py:174 update INFO | total_loss_c:-1.3717435893560017,actor_loss:-1.2240566571200455,entory_loss:-0.1476869285106659
2024-03-13 09:09:59,019 ppo.py:174 update INFO | total_loss_c:-1.419873448313706,actor_loss:-1.2721902450933387,entory_loss:-0.14768320322036743
2024-03-13 09:10:00,508 ppo.py:174 update INFO | total_loss_c:-1.466462692048463,actor_loss:-1.3187833556794253,entory_loss:-0.14767932891845703
2024-03-13 09:10:01,943 ppo.py:174 update INFO | total_loss_c:-1.5125010897273796,actor_loss:-1.3648257952983158,entory_loss:-0.1476752907037735
2024-03-13 09:10:03,473 ppo.py:174 update INFO | total_loss_c:-1.5569373491800818,actor_loss:-1.4092662270761522,entory_loss:-0.14767113327980042
2024-03-13 09:10:04,908 ppo.py:174 update INFO | total_loss_c:-1.599843253150718,actor_loss:-1.452176366701858,entory_loss:-0.14766687154769897
2024-03-13 09:10:06,324 ppo.py:174 update INFO | total_loss_c:-1.6423743967679503,actor_loss:-1.4947118838099005,entory_loss:-0.14766252040863037
2024-03-13 09:10:09,836 AutoFE.py:157 fit_attention INFO | worker1 ,results:[0.7226, 0.8129, 0.6903, 0.6581, 0.6903],cv:[ 0.03225806  0.06451613 -0.03225806  0.06451613 -0.09677419],
2024-03-13 09:10:09,839 AutoFE.py:157 fit_attention INFO | worker2 ,results:[0.5226, 0.6065, 0.6774, 0.5484, 0.5548],cv:[ 0.          0.         -0.09677419  0.06451613 -0.12903226],
2024-03-13 09:10:09,839 AutoFE.py:157 fit_attention INFO | worker3 ,results:[0.7419, 0.5097, 0.4258, 0.4323, 0.6581],cv:[ 0.06451613  0.          0.          0.12903226 -0.16129032],
2024-03-13 09:10:09,839 AutoFE.py:157 fit_attention INFO | worker4 ,results:[0.7742, 0.7161, 0.7097, 0.5742, 0.5742],cv:[ 0.          0.06451613 -0.03225806  0.09677419 -0.19354839],
2024-03-13 09:10:09,839 AutoFE.py:174 fit_attention INFO | epoch:1,baseline:[0.690325 0.6613   0.6258   0.55325  0.61935 ],score_b:0.8129032258064516,scores_b:[0.80645161 0.80645161 0.87096774 0.70967742 0.87096774]
2024-03-13 09:10:09,839 AutoFE.py:180 fit_attention INFO | top_1:score:0.8451612903225806
2024-03-13 09:10:09,839 AutoFE.py:180 fit_attention INFO | top_2:score:0.8387096774193548
2024-03-13 09:10:09,839 AutoFE.py:180 fit_attention INFO | top_3:score:0.8387096774193548
2024-03-13 09:10:09,839 AutoFE.py:180 fit_attention INFO | top_4:score:0.8387096774193548
2024-03-13 09:10:09,839 AutoFE.py:180 fit_attention INFO | top_5:score:0.8387096774193548
2024-03-13 09:10:10,726 ppo.py:174 update INFO | total_loss_c:36.20145353030004,actor_loss:36.345513255405805,entory_loss:-0.14405971765518188
2024-03-13 09:10:12,134 ppo.py:174 update INFO | total_loss_c:36.149084989375,actor_loss:36.293142024821165,entory_loss:-0.144057035446167
2024-03-13 09:10:13,540 ppo.py:174 update INFO | total_loss_c:36.06857776160931,actor_loss:36.21263271089291,entory_loss:-0.14405494928359985
2024-03-13 09:10:14,982 ppo.py:174 update INFO | total_loss_c:35.96819132080594,actor_loss:36.112244552730715,entory_loss:-0.14405323565006256
2024-03-13 09:10:16,375 ppo.py:174 update INFO | total_loss_c:35.85285806263341,actor_loss:35.99690974483742,entory_loss:-0.1440516710281372
2024-03-13 09:10:17,919 ppo.py:174 update INFO | total_loss_c:35.726295698955894,actor_loss:35.87034586496675,entory_loss:-0.14405016601085663
2024-03-13 09:10:19,320 ppo.py:174 update INFO | total_loss_c:35.591233104335004,actor_loss:35.735281716899806,entory_loss:-0.14404860138893127
2024-03-13 09:10:20,831 ppo.py:174 update INFO | total_loss_c:35.450431128710974,actor_loss:35.594478090972174,entory_loss:-0.14404696226119995
2024-03-13 09:10:22,259 ppo.py:174 update INFO | total_loss_c:35.30330936680336,actor_loss:35.447354511122896,entory_loss:-0.1440451443195343
2024-03-13 09:10:23,610 ppo.py:174 update INFO | total_loss_c:35.15160935988168,actor_loss:35.29565246274213,entory_loss:-0.14404310286045074
2024-03-13 09:10:24,904 ppo.py:174 update INFO | total_loss_c:34.997070617088895,actor_loss:35.14111139909349,entory_loss:-0.1440407782793045
2024-03-13 09:10:26,198 ppo.py:174 update INFO | total_loss_c:34.84031611014825,actor_loss:34.984354276999056,entory_loss:-0.14403817057609558
2024-03-13 09:10:27,552 ppo.py:174 update INFO | total_loss_c:34.68189846091245,actor_loss:34.82593367360805,entory_loss:-0.144035205245018
2024-03-13 09:10:28,888 ppo.py:174 update INFO | total_loss_c:34.523979716460616,actor_loss:34.6680116322743,entory_loss:-0.14403191208839417
2024-03-13 09:10:30,213 ppo.py:174 update INFO | total_loss_c:34.367441452405174,actor_loss:34.51146976213785,entory_loss:-0.14402830600738525
2024-03-13 09:10:31,554 ppo.py:174 update INFO | total_loss_c:34.213998838065905,actor_loss:34.35802323996906,entory_loss:-0.14402440190315247
2024-03-13 09:10:32,919 ppo.py:174 update INFO | total_loss_c:34.06341797510335,actor_loss:34.2074382680113,entory_loss:-0.14402028918266296
2024-03-13 09:10:34,278 ppo.py:174 update INFO | total_loss_c:33.91423004152481,actor_loss:34.058245990744275,entory_loss:-0.14401595294475555
2024-03-13 09:10:35,670 ppo.py:174 update INFO | total_loss_c:33.76648327837103,actor_loss:33.910494649208715,entory_loss:-0.14401136338710785
2024-03-13 09:10:37,043 ppo.py:174 update INFO | total_loss_c:33.620779506327395,actor_loss:33.76478613487053,entory_loss:-0.1440066248178482
2024-03-13 09:10:40,802 AutoFE.py:157 fit_attention INFO | worker1 ,results:[0.671, 0.6387, 0.729, 0.5613, 0.671],cv:[ 0.06451613  0.03225806  0.          0.16129032 -0.16129032],
2024-03-13 09:10:40,802 AutoFE.py:157 fit_attention INFO | worker2 ,results:[0.7677, 0.6903, 0.6581, 0.729, 0.5613],cv:[ 0.          0.          0.          0.09677419 -0.22580645],
2024-03-13 09:10:40,802 AutoFE.py:157 fit_attention INFO | worker3 ,results:[0.6516, 0.3677, 0.7161, 0.671, 0.6],cv:[ 0.          0.06451613 -0.06451613  0.03225806 -0.12903226],
2024-03-13 09:10:40,803 AutoFE.py:157 fit_attention INFO | worker4 ,results:[0.7226, 0.8065, 0.4323, 0.6516, 0.6774],cv:[-0.03225806  0.03225806  0.          0.06451613 -0.09677419],
2024-03-13 09:10:40,803 AutoFE.py:174 fit_attention INFO | epoch:2,baseline:[0.703225 0.6258   0.633875 0.653225 0.627425],score_b:0.8129032258064516,scores_b:[0.80645161 0.80645161 0.87096774 0.70967742 0.87096774]
2024-03-13 09:10:40,803 AutoFE.py:180 fit_attention INFO | top_1:score:0.8451612903225806
2024-03-13 09:10:40,803 AutoFE.py:180 fit_attention INFO | top_2:score:0.8387096774193548
2024-03-13 09:10:40,803 AutoFE.py:180 fit_attention INFO | top_3:score:0.8387096774193548
2024-03-13 09:10:40,803 AutoFE.py:180 fit_attention INFO | top_4:score:0.8387096774193548
2024-03-13 09:10:40,803 AutoFE.py:180 fit_attention INFO | top_5:score:0.8387096774193548
2024-03-13 09:10:41,819 ppo.py:174 update INFO | total_loss_c:10.470215926281575,actor_loss:10.632729435674314,entory_loss:-0.16251352429389954
2024-03-13 09:10:43,338 ppo.py:174 update INFO | total_loss_c:10.466700664951745,actor_loss:10.629210281416121,entory_loss:-0.16250962018966675
2024-03-13 09:10:44,927 ppo.py:174 update INFO | total_loss_c:10.45241814064708,actor_loss:10.614925011572506,entory_loss:-0.1625068634748459
2024-03-13 09:10:46,445 ppo.py:174 update INFO | total_loss_c:10.429364151560103,actor_loss:10.591869256697928,entory_loss:-0.162505105137825
2024-03-13 09:10:47,964 ppo.py:174 update INFO | total_loss_c:10.39896727211091,actor_loss:10.561471498080225,entory_loss:-0.16250422596931458
2024-03-13 09:10:49,481 ppo.py:174 update INFO | total_loss_c:10.362552681393037,actor_loss:10.52505676207603,entory_loss:-0.16250407695770264
2024-03-13 09:10:50,971 ppo.py:174 update INFO | total_loss_c:10.321207766088907,actor_loss:10.483712260279123,entory_loss:-0.16250449419021606
2024-03-13 09:10:52,461 ppo.py:174 update INFO | total_loss_c:10.275290626126337,actor_loss:10.437796010660934,entory_loss:-0.1625053882598877
2024-03-13 09:10:54,075 ppo.py:174 update INFO | total_loss_c:10.225664966633994,actor_loss:10.388171599140842,entory_loss:-0.16250663995742798
2024-03-13 09:10:55,608 ppo.py:174 update INFO | total_loss_c:10.172977483360041,actor_loss:10.33548562833475,entory_loss:-0.16250814497470856
2024-03-13 09:10:57,201 ppo.py:174 update INFO | total_loss_c:10.117899737177055,actor_loss:10.280409547356527,entory_loss:-0.16250981390476227
2024-03-13 09:10:58,781 ppo.py:174 update INFO | total_loss_c:10.060630946179607,actor_loss:10.22314252214668,entory_loss:-0.16251157224178314
2024-03-13 09:11:00,353 ppo.py:174 update INFO | total_loss_c:10.001719867177453,actor_loss:10.164233223833289,entory_loss:-0.1625133603811264
2024-03-13 09:11:01,922 ppo.py:174 update INFO | total_loss_c:9.941809372764437,actor_loss:10.104324487757294,entory_loss:-0.16251511871814728
2024-03-13 09:11:03,483 ppo.py:174 update INFO | total_loss_c:9.881178436568298,actor_loss:10.043695257744112,entory_loss:-0.16251681745052338
2024-03-13 09:11:05,064 ppo.py:174 update INFO | total_loss_c:9.819878685469957,actor_loss:9.9823971085206,entory_loss:-0.1625184267759323
2024-03-13 09:11:06,655 ppo.py:174 update INFO | total_loss_c:9.758559899230475,actor_loss:9.921079793770785,entory_loss:-0.1625198870897293
2024-03-13 09:11:08,140 ppo.py:174 update INFO | total_loss_c:9.697691188017894,actor_loss:9.860212356607486,entory_loss:-0.16252116858959198
2024-03-13 09:11:09,717 ppo.py:174 update INFO | total_loss_c:9.636877491567908,actor_loss:9.799399692062913,entory_loss:-0.16252219676971436
