2023-10-26 11:18:34,382 autofe.py:51 __init__ INFO | Namespace(cuda='0', train_size=0.7, epochs=300, ppo_epochs=30, episodes=3, lr=0.0001, entropy_weight=0.0001, baseline_weight=0.95, gama=0.9, gae_lambda=0.95, batch_size=4, d_model=128, d_k=32, d_v=32, d_ff=64, n_heads=6, worker=1, steps_num=3, combine=True, preprocess=True, seed=1, cv=5, cv_train_size=0.7, cv_seed=1, split_train_test=False, shuffle=False, enc_c_pth='', enc_d_pth='', mode='classify', model='xgb', metric='f1', file_name='credit_a', c_columns=['A2', 'A3', 'A8', 'A11', 'A14', 'A15'], d_columns=['A1', 'A4', 'A5', 'A6', 'A7', 'A9', 'A10', 'A12', 'A13'], target='label')
2023-10-26 11:18:34,382 autofe.py:52 __init__ INFO | File name: credit_a
2023-10-26 11:18:34,382 autofe.py:53 __init__ INFO | Data shape: (690, 16)
2023-10-26 11:18:35,937 autofe.py:120 set_cuda INFO | Use device: 0, cuda:0, NVIDIA GeForce RTX 4060 Laptop GPU
2023-10-26 11:18:35,937 autofe.py:110 __init__ INFO | Done AutoFE initialization.
2023-10-26 11:18:35,962 autofe.py:429 _get_cv_baseline INFO | Start getting CV baseline...
2023-10-26 11:18:35,962 autofe.py:446 _get_cv_baseline INFO | CV split end. Start CV scoring...
2023-10-26 11:18:36,002 autofe.py:477 _get_cv_baseline INFO | no encoding
2023-10-26 11:18:36,002 autofe.py:488 _get_cv_baseline INFO | Start training model...
2023-10-26 11:18:36,053 autofe.py:477 _get_cv_baseline INFO | no encoding
2023-10-26 11:18:36,053 autofe.py:488 _get_cv_baseline INFO | Start training model...
2023-10-26 11:18:36,112 autofe.py:477 _get_cv_baseline INFO | no encoding
2023-10-26 11:18:36,112 autofe.py:488 _get_cv_baseline INFO | Start training model...
2023-10-26 11:18:36,162 autofe.py:477 _get_cv_baseline INFO | no encoding
2023-10-26 11:18:36,162 autofe.py:488 _get_cv_baseline INFO | Start training model...
2023-10-26 11:18:36,202 autofe.py:477 _get_cv_baseline INFO | no encoding
2023-10-26 11:18:36,202 autofe.py:488 _get_cv_baseline INFO | Start training model...
2023-10-26 11:18:36,214 autofe.py:140 fit_attention INFO | score_b=0.75796, scores_b=[0.7029, 0.8261, 0.8043, 0.6884, 0.7681]
2023-10-26 11:18:36,246 model_rl.py:14 __init__ INFO | Randomly initial encoder
2023-10-26 11:18:36,282 model_rl.py:14 __init__ INFO | Randomly initial encoder
2023-10-26 11:18:49,632 autofe.py:314 fit_attention INFO | worker1 ,results:[0.7942, 0.7884, 0.7438],cv:[-0.05072609  0.10143623  0.14497536  0.0942087   0.10146522],feature_nums:(7.571428571428571, 106, 14),repeat_nums:[0.041666666666666664],ff_c:[[{'add': [[5, 5]]}, {'subtract': [[2, 3], [4, 4]]}, {'multiply': []}, {'divide': []}, {'value_convert': {3: 'square', 1: 'abss', 0: 'sqrt'}}], [{'add': [[3, 1], [6, 4], [7, 4], [9, 2]]}, {'subtract': [[1, 0], [4, 2], [5, 3]]}, {'multiply': [[0, 3], [2, 0]]}, {'divide': []}, {'value_convert': {8: 'abss'}}], [{'add': []}, {'subtract': [[7, 1], [10, 0], [15, 1], [18, 5]]}, {'multiply': [[5, 2], [6, 5], [12, 5], [13, 3], [16, 3], [17, 2]]}, {'divide': [[0, 0], [3, 0], [4, 5], [11, 2], [14, 4]]}, {'value_convert': {19: 'terminate', 9: 'sqrt', 8: 'abss', 2: 'inverse', 1: 'terminate'}}]],ff_d:[[{'combine': [[0, 8], [1, 8], [4, 5], [5, 11], [7, 6], [8, 12], [9, 7], [10, 11], [11, 6], [12, 10], [13, 2], [14, 13]]}, {'delete': {}}, {'none': {2: 'None'}}], [{'combine': [[0, 11], [1, 14], [2, 4], [3, 9], [5, 9], [8, 5], [10, 5], [11, 13], [14, 1], [15, 10], [16, 0], [17, 14], [19, 3], [21, 7], [22, 13], [23, 12], [24, 8], [25, 12], [26, 6]]}, {'delete': {9: 'delete', 18: 'delete', 20: 'delete'}}, {'none': {6: 'None', 12: 'None', 13: 'None'}}], [{'combine': [[0, 6], [1, 6], [2, 0], [3, 8], [7, 3], [8, 4], [9, 7], [10, 11], [12, 9], [13, 11], [14, 2], [15, 4], [16, 14], [17, 5], [18, 9], [19, 1], [20, 5], [21, 6], [22, 2], [23, 13], [25, 7], [26, 10], [27, 13], [29, 9], [30, 6], [31, 8], [32, 12], [33, 3], [35, 1], [36, 13], [37, 4], [38, 12], [39, 0], [40, 0], [41, 10], [44, 6], [45, 9]]}, {'delete': {5: 'delete', 6: 'delete', 28: 'delete'}}, {'none': {11: 'None', 34: 'None', 42: 'None'}}]]
2023-10-26 11:18:49,632 autofe.py:314 fit_attention INFO | worker2 ,results:[0.8043, 0.771, 0.7884],cv:[-0.04347971  0.12317536  0.09425072  0.08696232  0.10871159],feature_nums:(7.571428571428571, 106, 14),repeat_nums:[0.0],ff_c:[[{'add': []}, {'subtract': [[2, 2]]}, {'multiply': [[1, 5], [5, 0]]}, {'divide': [[3, 3]]}, {'value_convert': {4: 'abss', 0: 'abss'}}], [{'add': []}, {'subtract': [[4, 1], [7, 2], [8, 3]]}, {'multiply': [[2, 4]]}, {'divide': [[1, 5], [3, 2], [9, 3]]}, {'value_convert': {6: 'square', 5: 'log', 0: 'square'}}], [{'add': [[8, 2], [9, 0], [12, 2], [18, 5]]}, {'subtract': [[6, 5], [13, 3], [16, 1]]}, {'multiply': [[2, 5], [3, 2], [10, 2], [17, 5]]}, {'divide': [[0, 0], [4, 2], [7, 4], [19, 0]]}, {'value_convert': {15: 'sqrt', 14: 'log', 11: 'terminate', 5: 'delete', 1: 'abss'}}]],ff_d:[[{'combine': [[0, 10], [2, 14], [3, 13], [4, 0], [5, 4], [6, 2], [8, 0], [9, 6], [11, 8], [12, 14], [13, 0]]}, {'delete': {}}, {'none': {10: 'None'}}], [{'combine': [[0, 2], [1, 8], [2, 6], [4, 3], [5, 9], [6, 11], [7, 1], [8, 2], [9, 7], [11, 13], [12, 14], [14, 0], [15, 2], [16, 8], [18, 13], [19, 4], [21, 4], [22, 7], [23, 13], [24, 1], [25, 11]]}, {'delete': {10: 'delete'}}, {'none': {17: 'None', 20: 'None'}}], [{'combine': [[0, 13], [1, 12], [2, 12], [4, 3], [5, 0], [6, 4], [7, 3], [8, 0], [9, 2], [12, 8], [14, 11], [15, 14], [16, 14], [17, 12], [18, 6], [20, 5], [21, 13], [22, 7], [23, 8], [24, 7], [25, 13], [26, 3], [27, 14], [28, 4], [29, 3], [30, 9], [31, 13], [32, 9], [33, 12], [34, 3], [35, 13], [36, 8], [37, 7], [38, 7], [41, 7], [42, 8], [43, 10], [44, 11], [45, 4]]}, {'delete': {19: 'delete'}}, {'none': {3: 'None', 11: 'None'}}]]
2023-10-26 11:18:49,632 autofe.py:314 fit_attention INFO | worker3 ,results:[0.7797, 0.8435, 0.8101],cv:[-0.02898696  0.12317536  0.09425072  0.10870145  0.10871159],feature_nums:(8.0, 112, 14),repeat_nums:[0.0],ff_c:[[{'add': []}, {'subtract': [[2, 5], [5, 1]]}, {'multiply': [[0, 3]]}, {'divide': [[4, 1]]}, {'value_convert': {3: 'inverse', 1: 'abss'}}], [{'add': []}, {'subtract': [[10, 3]]}, {'multiply': [[0, 1], [1, 5], [4, 0], [7, 3], [8, 1], [9, 5]]}, {'divide': [[3, 1]]}, {'value_convert': {11: 'log', 6: 'sqrt', 5: 'log', 2: 'terminate'}}], [{'add': [[6, 2], [12, 1], [15, 4], [18, 5]]}, {'subtract': [[7, 2], [14, 0]]}, {'multiply': [[0, 4], [9, 3], [17, 2], [20, 0]]}, {'divide': [[2, 4], [3, 2], [4, 4], [5, 2], [16, 3]]}, {'value_convert': {21: 'square', 19: 'None', 13: 'inverse', 11: 'abss', 10: 'None', 8: 'delete', 1: 'None'}}]],ff_d:[[{'combine': [[0, 8], [1, 14], [2, 11], [3, 9], [4, 5], [5, 8], [7, 12], [8, 2], [9, 0], [10, 6], [11, 12], [12, 10], [14, 0]]}, {'delete': {}}, {'none': {}}], [{'combine': [[0, 14], [1, 10], [2, 13], [5, 0], [6, 3], [7, 5], [8, 4], [9, 5], [10, 14], [11, 13], [12, 1], [13, 14], [14, 6], [15, 8], [17, 1], [18, 0], [19, 4], [20, 0], [22, 4], [23, 9], [24, 14], [25, 8], [26, 8], [27, 14]]}, {'delete': {16: 'delete'}}, {'none': {3: 'None', 4: 'None', 21: 'None'}}], [{'combine': [[0, 6], [1, 8], [2, 7], [3, 0], [6, 5], [7, 3], [8, 4], [9, 14], [10, 4], [11, 0], [12, 10], [15, 7], [17, 6], [18, 13], [19, 12], [20, 4], [22, 6], [23, 4], [25, 12], [27, 8], [28, 0], [29, 7], [31, 9], [32, 3], [34, 0], [35, 1], [36, 2], [37, 9], [38, 13], [39, 14], [40, 8], [42, 4], [43, 5], [46, 0], [47, 10], [49, 9], [50, 0], [51, 1]]}, {'delete': {5: 'delete', 16: 'delete', 26: 'delete', 45: 'delete', 48: 'delete'}}, {'none': {4: 'None', 21: 'None', 30: 'None', 41: 'None', 44: 'None'}}]]
2023-10-26 11:18:49,632 autofe.py:329 fit_attention INFO | epoch:0,baseline:[0.79273333 0.80096667 0.78076667],score_b:0.75796,scores_b:[0.7029, 0.8261, 0.8043, 0.6884, 0.7681]
